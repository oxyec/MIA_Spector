# ğŸ§  MIA-Spector: Membership Inference Analysis Toolkit

**MIA-Spector** æ˜¯ä¸€ä¸ªé¢å‘å¤§æ¨¡å‹éšç§è¯„ä¼°çš„ç»Ÿä¸€å¹³å°ï¼Œæ—¨åœ¨å¯¹ **æ–‡æœ¬ç”Ÿæˆæ¨¡å‹** ä¸ **å¤šæ¨¡æ€æ¨¡å‹ï¼ˆå›¾åƒ-æ–‡æœ¬ï¼‰** è¿›è¡Œæˆå‘˜æ¨ç†æ”»å‡»ï¼ˆMembership Inference Attack, MIAï¼‰åˆ†æä¸å¯è§†åŒ–ã€‚

æœ¬é¡¹ç›®åŒ…å«ä¸¤ä¸ªæ ¸å¿ƒå­æ¨¡å—ï¼š

1. ğŸ“ **Text-MIA Inspector** â€” é’ˆå¯¹ LLM çš„æ–‡æœ¬æˆå‘˜æ”»å‡»åˆ†æ
2. ğŸ–¼ï¸ **Image-MIA Inspector** â€” é’ˆå¯¹è§†è§‰/å¤šæ¨¡æ€æ¨¡å‹çš„å›¾åƒæˆå‘˜æ”»å‡»åˆ†æ

---

## ğŸŒŸ åŠŸèƒ½æ¦‚è§ˆ

| æ¨¡å—                      | åŠŸèƒ½                                                                                   | ç‰¹ç‚¹                                                                      |
| ----------------------- | ------------------------------------------------------------------------------------ | ----------------------------------------------------------------------- |
| **Text-MIA Inspector**  | è®¡ç®—æ–‡æœ¬æ ·æœ¬åœ¨ç»™å®šè¯­è¨€æ¨¡å‹ä¸‹çš„ MIA æŒ‡æ ‡ï¼ˆMin-K%ã€Min-K++ã€å›°æƒ‘åº¦ç»Ÿè®¡ã€éšè—å±‚èŒƒæ•°ç­‰ï¼‰ï¼Œè‡ªåŠ¨ç”Ÿæˆé˜ˆå€¼é…ç½®ã€å¯è§†åŒ– ROC / AUC å¹¶æ”¯æŒå•æ ·æœ¬æ¨æ–­ã€‚ | æ”¯æŒ Hugging Face Transformers æ¨¡å‹ï¼Œå…¼å®¹ LLaMAã€Pythiaã€GPT-Neo ç­‰ï¼›æ”¯æŒ Gradio UIã€‚ |
| **Image-MIA Inspector** | åŸºäºè§†è§‰ç‰¹å¾åˆ†å¸ƒå·®å¼‚ï¼ˆç†µã€ç½®ä¿¡åº¦ã€KL è·ç¦»ã€ç‰¹å¾æ¨¡é•¿ï¼‰å®ç°å›¾åƒæ¨¡å‹æˆå‘˜æ¨ç†ï¼›å…¼å®¹ ViTã€CLIPã€LLaVA ç­‰æ¨¡å‹ã€‚                        | é€‚ç”¨äºå¤šæ¨¡æ€éšç§è¯„ä¼°ï¼Œå¯æ‰©å±•åˆ° VL-MIAã€‚                                                 |

---

## ğŸ§© æ¨¡å—ç»“æ„

```
MIA-Spector/
â”‚
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ gradio_text.py         # æ–‡æœ¬ MIA Gradio å‰ç«¯
â”‚   â””â”€â”€ gradio_image.py        # å›¾åƒ MIA å‰ç«¯ï¼ˆå¼€å‘ä¸­ï¼‰  
â”‚
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ metric_score.py        # æŒ‡æ ‡è®¡ç®—ï¼ˆMin-K++ã€PPLç­‰ï¼‰
â”‚   â””â”€â”€ load_yaml.py           # YAML é˜ˆå€¼åŠ è½½ä¸åˆ¤å†³é€»è¾‘
â”‚                 
â”‚â”€â”€ attacks/                   # æ”»å‡»ç±»å®ç°ï¼ˆScoreCalculatorç­‰ï¼‰          
â”‚â€”â€” configs/                   # å„æ¨¡å‹çš„é˜ˆå€¼é…ç½® (*.yaml)
â”œâ”€â”€ datasets/                  # ç¤ºä¾‹æ•°æ®é›† (WikiMIA_length32/64/128)
â””â”€â”€ README.md
```

---

## âš™ï¸ ç¯å¢ƒå®‰è£…

```bash
# åˆ›å»ºç¯å¢ƒ
conda create -n MIA python=3.11
conda activate MIA

# å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

æ ¸å¿ƒä¾èµ–ï¼š

```
torch >= 2.1
transformers >= 4.40
datasets
gradio
numpy, pandas, scipy, scikit-learn
matplotlib, seaborn, tqdm
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ğŸ“ 1. æ–‡æœ¬ MIA å·¥å…·

å¯åŠ¨ Web ç•Œé¢ï¼š

```bash
python -m scripts.gradio_text
```

è‹¥åœ¨è¿œç¨‹æœåŠ¡å™¨è¿è¡Œï¼Œè¯·ä½¿ç”¨ç«¯å£è½¬å‘ï¼š

```bash
ssh -L 7860:127.0.0.1:7860 -p <port> <user>@<server_ip>
```

ç„¶ååœ¨æµè§ˆå™¨æ‰“å¼€ï¼š

```
http://127.0.0.1:7860
```

ç•Œé¢åŠŸèƒ½ï¼š

* è¾“å…¥æ–‡æœ¬æ ·æœ¬ï¼›
* é€‰æ‹©æ¨¡å‹ï¼ˆå¦‚ Pythia-2.8B, LLaMA-2-7B ç­‰ï¼‰ï¼›
* é€‰æ‹©æŒ‡æ ‡ï¼ˆMin-K++, perplexity_range ç­‰ï¼‰ï¼›
* ç‚¹å‡»ã€Œæ¨ç†ã€å³å¯è·å¾—ï¼š

  * åˆ¤å†³ç»“æœï¼š`Yes / No / Uncertain`
  * ç½®ä¿¡åº¦ï¼š`0~1`
  * æŒ‡æ ‡å€¼ã€é˜ˆå€¼ã€æ–¹å‘ã€æ¨¡å¼ç­‰è¯¦ç»†ä¿¡æ¯ã€‚

> ğŸ“„ é˜ˆå€¼é…ç½®æ–‡ä»¶ä½äº `src/configs/*.yaml`ï¼Œè‡ªåŠ¨åŠ è½½å¹¶æ”¯æŒè‡ªå®šä¹‰ alphaã€‚

---

### ğŸ–¼ï¸ 2. å›¾åƒ MIA å·¥å…·ï¼ˆå¼€å‘ä¸­ï¼‰

ç›®æ ‡åŠŸèƒ½ï¼š

* å¯¹ CLIP / LLaVA / ViT æ¨¡å‹æ‰§è¡Œå›¾åƒæˆå‘˜æ¨ç†ï¼›
* è®¡ç®—æŒ‡æ ‡ï¼šæœ€å¤§ç½®ä¿¡åº¦ã€ç†µã€KL-gapã€Renyi-entropy ç­‰ï¼›
* æ”¯æŒæ‰¹é‡åˆ†æä¸å•æ ·æœ¬æ¨æ–­ï¼›
* æä¾› Gradio å‰ç«¯ä¸å¯è§†åŒ–æŠ¥å‘Šã€‚

é¢„è®¡ç»“æ„ï¼š

```bash
python -m scripts.gradio_image
```

---

## ğŸ§  èƒŒæ™¯åŸç†

**Membership Inference Attack (MIA)**ï¼š
ç”¨äºè¯„ä¼°æ¨¡å‹æ˜¯å¦æ³„éœ²è®­ç»ƒæ•°æ®éšç§ã€‚æ”»å‡»è€…é€šè¿‡è¾“å‡ºåˆ†å¸ƒï¼ˆå¦‚å›°æƒ‘åº¦ã€ç½®ä¿¡åº¦ã€æ¢¯åº¦ã€ç‰¹å¾æ¨¡é•¿ç­‰ï¼‰åŒºåˆ†æ ·æœ¬æ˜¯å¦è¢«æ¨¡å‹è®­ç»ƒè¿‡ã€‚

MIA-Spector æä¾›ï¼š

* å•æ ·æœ¬åˆ†ææ¥å£ï¼ˆAPI / Gradioï¼‰ï¼›
* æ‰¹é‡æ•°æ®é›†è¯„ä¼°ï¼ˆAUROCã€TPR@FPRã€Youden J é˜ˆå€¼ç­‰ï¼‰ï¼›
* æ¦‚ç‡æ ¡å‡†å™¨ï¼ˆSigmoid / ECDF / è·ç¦»æ˜ å°„ï¼‰ï¼›
* YAML-åŒ–é…ç½®ä¸è·¨æ¨¡å‹å¤ç”¨ã€‚

---

## ğŸ“Š è¾“å‡ºæ ¼å¼

JSON/YAML ç»“æ„ï¼š

```yaml
data_name: WikiMIA_length128
alpha: 0.01
thresholds:
  mink++:
    '0.3':
      direction: '+'
      threshold_bestJ: -1.4950
      threshold_fpr_alpha: -1.3490
      calibrator:
        a: 0.763
        b: 2.137
      stats:
        posdir_means:
          member: -2.20
          non_member: -2.45
```

---

## ğŸ“¦ æœªæ¥è§„åˆ’

* [ ] å®Œå–„ **å›¾åƒ-MIA Inspector**
* [ ] å¢åŠ  **RAG + MIA æ··åˆæµ‹è¯•æ¨¡å¼**
* [ ] æ”¯æŒ **Diffusion / LVLM æˆå‘˜æ”»å‡»**
* [ ] å¢åŠ  Web API ä¸ Docker éƒ¨ç½²ç‰ˆæœ¬
* [ ] å‘å¸ƒåœ¨çº¿ Demo é¡µé¢ä¸è®ºæ–‡ç‰ˆä»‹ç»

---

## ğŸ§¾ å¼•ç”¨

è‹¥æœ¬å·¥å…·å¯¹ä½ çš„ç ”ç©¶æœ‰å¸®åŠ©ï¼Œè¯·å¼•ç”¨ï¼š

```bibtex
@misc{MIA-Spector2025,
  title  = {MIA-Spector: Unified Toolkit for Text and Image Membership Inference Analysis},
  author = {Liu, Jiajun and Collaborators},
  year   = {2025},
  url    = {https://github.com/JiajunLiu/MIA-Spector}
}
```

---

## ğŸ›¡ï¸ å…è´£å£°æ˜

æœ¬é¡¹ç›®ä»…ç”¨äº **éšç§å®‰å…¨ç ”ç©¶ä¸æ¨¡å‹é²æ£’æ€§åˆ†æ**ã€‚
ä»»ä½•å°†å…¶ç”¨äºæ”»å‡»ç”Ÿäº§æ¨¡å‹æˆ–æ•°æ®æ³„éœ²çš„è¡Œä¸ºå‡ä¸ä½œè€…æ— å…³ã€‚

